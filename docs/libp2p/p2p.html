<div class="row">
    <h1>Architettura peer-to-peer</h1>
    <hr>
</div>
<div class="container my-3">
    <p>
        Esistono principalmente tre tipologie di architettura per la comunicazione tra computer: centralizzata, decentralizzata e distribuita.
    </p>
    <div class="card border-0 justify-content-center my-4" style="background-color: transparent;">
        <img src="docs/libp2p/img/type-net.png" class="card-img-top mx-auto rounded" alt="..." style="width: 40em;">
    </div>
    <p>
        Mentre il modello client-server si può definire centralizzato, un'architettura peer-to-peer solitamente si serve di una struttura decentralizzata o distribuita.
    </p>
    <p>
        La comunicazione tra i nodi viene gestita automaticamente per mezzo di Libp2p, uno stack di rete modulabile che supporta la gestione dei protocolli di rete che regolano il funzionamento del sistema peer-to-peer: attraverso lo stack libp2p i peers possono ‘ascoltare’ il flusso di pacchetti che circolano a livello TCP/IP instaurando un ‘dialogo’ sicuro con gli altri nodi IPFS.
    </p>
    <p>
        Lo stack libp2p può essere rappresentato, in rapporto allo standard OSI-ISO RM, come:
    </p>
    <div class="card border-0 justify-content-center my-4" style="background-color: transparent;">
        <img src="docs/libp2p/img/ipfs-osi.png" class="card-img-top mx-auto rounded" alt="..." style="width: 50em;">
    </div>
    <p>
        Libp2p si definisce modulabile in quanto supporti molteplici moduli e protocolli per il funzionamento della rete peer-to-peer (Peer Discovery, Peer Routing, Content Routing, Transports, Stream and Protocol Multiplexers, Encryption, Authentication, PubSub, ecc.) e permetta agli sviluppatori di scegliere quale protocollo di trasporto utilizzare (TCP-UDP/IP, QUIC, Ethernet) ed eventualmente supportare più trasporti contemporaneamente.
    </p>
    <p>
        La comunicazione all'interno della rete peer-to-peer viene gestita da parte di Libp2p per mezzo di una serie di strategie:
    </p>
    <ul class="px-5">
        <li><b>Negoziazione del protocollo</b>: per stabilire la connesione tra i nodi viene prima stabilito il protocollo di comunicazione da utilizzare per lo scambio</li>
        <li><b>PeerID</b>: ogni nodo della rete viene identificato attraverso l'impronta digitale della propria chiave pubblica </li>
        <li><b>Multiaddress</b>: stringa autodescrittiva che riporta l'IP, il protocollo e il PeerID di un nodo</li>
        <li><b>Routing</b>: le richieste vengono indirizzate per mezzo di tabelle distribuite tra i nodi (Distributed Hash Table)</li>
        <li><b>Exchange</b>: lo scambio dei blocchi di dati avviene per mezzo del protocollo BitSwap</li>
    </ul>
    <p>
        La comunicazione all’interno della rete IPFS avviene nel seguente modo:
    </p>
    <ol class="px-5">
        <li>Un nodo, identificato attraverso un codice univoco noto come PeerID (hash della sua chiave pubblica), inoltra la richiesta per la ricerca del contenuto all'interno della rete.</li>
        <li>L’instradamento delle richieste avviene per mezzo di tabelle distribuite (Distributed Hash Table) contenenti coppie di PeerID e dei CIDs da loro posseduti; tramite l’interrogazione di queste tabelle è quindi possibile risalire ai nodi in possesso dei contenuti richiesti.    </li>
        <li>Prima dell’invio i peers in possesso dei blocchi richiesti codificano il contenuto con la chiave pubblica del peer che ha eseguito la richiesta, in questo modo solo con la chiave privata corretta sarà possibile decodificare correttamente il contenuto dei blocchi ricevuti.</li>
    </ol>
    <p>
        La componente libp2p responsabile della gestione del trasporto è chiamata ‘switch’ e fornisce un unico "punto di ingresso" per l’ascolto e il dialogo liberando il codice dell'applicazione dalla gestione di trasporti specifici e di altri pezzi dello "stack di connessione" utilizzati in background.
        Lo switch coordina principalmente tre servizi distinti: Network (instaurazione di una comunicazione sicura), Routing (instradamento delle richieste) ed Exchange (scambio di blocchi). 

    </p>
    <br><hr><br>
    <p>
        Libp2p supporta una moltitudine di protocolli: <br>

    </p>
    <p class="px-5">    
        <b>Exchange</b>: BitTorrent, BitSwap, FTP, HTTP <br>
        <b>Routing</b>: Gossip, Chord, Kad DHT, mDNS, Delegato, [I2P, TOR] <br>
        <b>Network</b>: CJDNS, UDT, uTP, WebRTC, QUIC, TCP, WebSockets, [I2P, TOR] <br>
    </p>
    <br><hr><br>

</div>


